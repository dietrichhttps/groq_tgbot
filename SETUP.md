# Запуск ChatGPT Telegram Bot

## Быстрый старт

### 1. Подготовка API ключей

#### Telegram Bot Token
1. Откройте Telegram и найдите бота [@BotFather](https://t.me/botfather)
2. Отправьте команду `/newbot`
3. Следуйте инструкциям BotFather
4. Скопируйте полученный токен

#### OpenAI API Key
1. Перейдите на [platform.openai.com](https://platform.openai.com/api-keys)
2. Войдите в свой аккаунт (создайте, если нужно)
3. Создайте новый API ключ в разделе "API keys"
4. Скопируйте ключ

### 2. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 3. Конфигурация

```bash
# Скопируйте шаблон .env
cp .env.example .env

# Отредактируйте .env и добавьте ваши ключи
# Используйте любой текстовый редактор:
nano .env
# или
code .env
# или
vim .env
```

Пример содержимого `.env`:
```
TELEGRAM_BOT_TOKEN=1234567890:ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefgh
OPENAI_API_KEY=sk-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
OPENAI_MODEL=gpt-3.5-turbo
LOG_LEVEL=INFO
```

### 4. Запуск бота

```bash
python bot.py
```

Вы должны увидеть сообщение: `Starting bot...`

### 5. Использование бота в Telegram

1. Откройте Telegram
2. Найдите вашего бота (по имени, которое вы выбрали при создании)
3. Отправьте команду `/start`
4. Используйте любой из доступных функционала:
   - Просто напишите текст и отправьте - бот ответит с помощью ChatGPT
   - `/start` - начать новый диалог (очистить историю)
   - `/help` - получить справку
   - "Новый запрос" - кнопка для сброса контекста

## Возможные проблемы

### Ошибка: `TELEGRAM_BOT_TOKEN not found`
- Убедитесь, что в файле `.env` заполнено поле `TELEGRAM_BOT_TOKEN`
- Убедитесь, что файл `.env` находится в корне проекта

### Ошибка: `OPENAI_API_KEY not found`
- Убедитесь, что в файле `.env` заполнено поле `OPENAI_API_KEY`
- Проверьте валидность ключа на [platform.openai.com](https://platform.openai.com/api-keys)

### Бот не отвечает
- Проверьте подключение к интернету
- Убедитесь, что OpenAI API доступен в вашей стране
- Проверьте баланс вашего OpenAI аккаунта
- Посмотрите логи для деталей ошибки

### Rate limit (слишком много запросов)
- Дождитесь немного и попробуйте снова
- Проверьте лимиты своего OpenAI плана на [platform.openai.com](https://platform.openai.com)

## Режимы запуска

### Стандартный запуск
```bash
python bot.py
```

### С более подробным логированием
```bash
LOG_LEVEL=DEBUG python bot.py
```

### Запуск в фоновом режиме (Linux/Mac)
```bash
nohup python bot.py > bot.log 2>&1 &
```

### Запуск в фоновом режиме (Windows)
```bash
start python bot.py
```

## Тестирование

Запустите тесты для проверки функциональности:
```bash
python -m pytest test_bot.py -v
```

## Остановка бота

- В терминале: `Ctrl + C`
- Если запущен в фоновом режиме (Linux/Mac): `pkill -f "python bot.py"`
- Если запущен в фоновом режиме (Windows): используйте Task Manager

## Дополнительные советы

- **Контекст диалога**: Бот помнит последние сообщения в беседе. Используйте "Новый запрос" для смены темы.
- **Длинные ответы**: ChatGPT может предоставлять ответы до 2000 символов за раз.
- **Температура**: По умолчанию установлена 0.7 (достаточно креативных, но логичных ответов).
- **Модель**: По умолчанию используется gpt-3.5-turbo (быстрая и дешевая). Для лучшего качества используйте gpt-4.

## Поддержка и обратная связь

Если у вас есть проблемы или предложения, создайте issue в репозитории.
