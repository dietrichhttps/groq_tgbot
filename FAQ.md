# FAQ - Часто задаваемые вопросы

## Общие вопросы

### Q: Как получить Telegram Bot Token?
**A:** 
1. Откройте Telegram и найдите бота [@BotFather](https://t.me/botfather)
2. Отправьте команду `/newbot`
3. Выберите имя для бота
4. ВыберитеUsername для бота
5. BotFather отправит вам токен
6. Скопируйте токен и вставьте в файл `.env` (TELEGRAM_BOT_TOKEN)

### Q: Как получить OpenAI API ключ?
**A:**
1. Перейдите на [platform.openai.com](https://platform.openai.com)
2. Создайте аккаунт или войдите
3. Перейдите в "API keys"
4. Нажмите "Create new secret key"
5. Скопируйте ключ и вставьте в файл `.env` (OPENAI_API_KEY)
6. **Важно:** Никому не передавайте этот ключ!

### Q: Какие модели ChatGPT доступны?
**A:** 
- `gpt-3.5-turbo` (рекомендуется, быстро и дешево)
- `gpt-4` (мощнее, но медленнее и дороже)
- `gpt-4-turbo-preview` (баланс между качеством и скоростью)

Измените в файле `.env`:
```
OPENAI_MODEL=gpt-4
```

### Q: Сколько стоит использование бота?
**A:** 
Цена зависит от:
- Модели ChatGPT (gpt-3.5-turbo дешевле)
- Количества сообщений и их длины
- Размера контекста (история диалогов)

OpenAI имеет разные тарифы - смотрите [pricing](https://openai.com/pricing)

## Установка и запуск

### Q: Я получаю ошибку "ModuleNotFoundError: No module named 'telegram'"
**A:**
1. Убедитесь, что установлены зависимости:
```bash
pip install -r requirements.txt
```
2. Убедитесь, что используете правильное виртуальное окружение
3. Проверьте версию Python (3.8+):
```bash
python --version
```

### Q: Бот не запускается. Что делать?
**A:**
1. Проверьте наличие файла `.env`:
```bash
ls -la .env
```
2. Проверьте, что заполнены все ключи в `.env`
3. Запустите с подробным логированием:
```bash
LOG_LEVEL=DEBUG python bot.py
```
4. Проверьте конец файла `.env` (не должно быть пробелов в конце строк)

### Q: Как использовать виртуальное окружение?
**A:**
```bash
# Создание
python3 -m venv venv

# Активация (Linux/Mac)
source venv/bin/activate

# Активация (Windows)
venv\Scripts\activate

# Установка зависимостей
pip install -r requirements.txt

# Запуск
python bot.py

# Деактивация
deactivate
```

## Проблемы с работой

### Q: Бот получает сообщения, но не отвечает
**A:**
1. Проверьте API ключ OpenAI (правильный и активный)
2. Проверьте баланс в аккаунте OpenAI
3. Проверьте интернет-соединение
4. Проверьте логи:
```bash
tail -f bot.log  # Если используется nohup
```
5. Попробуйте отправить сообщение через несколько секунд

### Q: Я получаю ошибку "Rate limit exceeded"
**A:**
1. Это означает, что вы отправили слишком много запросов за короткое время
2. Подождите несколько секунд и попробуйте снова
3. Проверьте лимиты в аккаунте OpenAI
4. Если лимиты низкие, обновите план на openai.com

### Q: Сообщения очень долго обрабатываются
**A:**
1. Это нормально для больших запросов
2. Размер контекста (история) влияет на скорость
3. Используйте "Новый запрос" для сброса истории если она большая
4. gpt-3.5-turbo работает быстрее чем gpt-4

### Q: Бот забывает контекст предыдущих сообщений
**A:**
1. История хранится в памяти и теряется при:
   - Перезагрузке бота
   - Команде `/start`
   - Нажатии кнопки "Новый запрос"
2. Если хотите персистентного хранилища, нужно добавить БД

### Q: Почему ответы иногда некорректны?
**A:**
1. ChatGPT иногда может давать неправильные ответы (это норма для LLM)
2. Более подробные вопросы обычно дают лучшие ответы
3. Добавляйте контекст в вопрос
4. Используйте более мощную модель (gpt-4)

## Развертывание

### Q: Как запустить бота на сервере?
**A:**
1. SSH на сервер
2. Установите Python 3.8+
3. Клонируйте репозиторий
4. Используйте скрипт deploy.sh или следуйте DEPLOYMENT.md

### Q: Как запустить бота в фоновом режиме?
**A:**
**Linux/Mac:**
```bash
nohup python3 bot.py > bot.log 2>&1 &
```

**Windows:**
```cmd
start python bot.py
```

**Systemd (Linux):**
```bash
sudo systemctl start chatgpt-bot
```

### Q: Как использовать Docker?
**A:**
```bash
# Подготовка
cp .env.example .env
# Отредактируйте .env

# Запуск
docker-compose up -d

# Логи
docker-compose logs -f

# Остановка
docker-compose down
```

### Q: Как остановить бота?
**A:**
**nohup:**
```bash
pkill -f "python.*bot.py"
```

**Systemd:**
```bash
sudo systemctl stop chatgpt-bot
```

**Docker:**
```bash
docker-compose down
```

**Вручную (если запущен в терминале):**
```bash
Ctrl + C
```

## Безопасность

### Q: Мой API ключ скомпрометирован, что делать?
**A:**
1. Немедленно удалите старый ключ в аккаунте OpenAI
2. Создайте новый ключ
3. Обновите файл `.env`
4. Перезагрузите бота

### Q: Можно ли хранить API ключи в коде?
**A:** 
**НЕТ!** Это очень опасно:
- Никогда не коммитьте `.env` файл
- Используйте переменные окружения
- Если случайно заколи ключ, немедленно удалите его

### Q: Как защитить бота от несанкционированного использования?
**A:**
1. Используйте приватного бота (не публикуйте токен)
2. Ограничьте доступ в коде (проверка user_id)
3. Установите лимиты на количество запросов в день
4. Регулярно проверяйте логи

## Производительность

### Q: Как улучшить скорость бота?
**A:**
1. Используйте более быструю модель (gpt-3.5-turbo)
2. Уменьшайте историю диалога
3. Используйте более мощный сервер
4. Добавьте кэширование часто используемых ответов

### Q: Сколько одновременно может быть пользователей?
**A:**
- В памяти можно хранить историю для тысяч пользователей
- Ограничение зависит от:
  - Объема памяти сервера
  - Лимитов OpenAI API
  - Лимитов Telegram Bot API

## Разработка

### Q: Как добавить новую команду?
**A:**
1. Создайте новую функцию-обработчик:
```python
async def my_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text("Привет!")
```
2. Добавьте обработчик в функцию `main()`:
```python
application.add_handler(CommandHandler("mycommand", my_command))
```
3. Перезагрузите бота

### Q: Как изменить температуру ответов?
**A:**
В файле `chatgpt_client.py` найдите строку:
```python
temperature=0.7
```
- 0 = детерминированные ответы
- 0.5 = сбалансированные
- 1.0 = креативные ответы

### Q: Как запустить тесты?
**A:**
```bash
python -m pytest test_bot.py -v
```

## Если ничего не помогло

1. **Проверьте логи:**
```bash
grep -i error bot.log
```

2. **Создайте issue на GitHub:**
   - Включите текст ошибки
   - Опишите, что вы пытались делать
   - Укажите версию Python

3. **Проверьте документацию:**
   - README.md - основная информация
   - SETUP.md - установка
   - DEPLOYMENT.md - развертывание
   - ARCHITECTURE.md - архитектура

## Контакты

Если у вас остались вопросы - создайте issue в репозитории или свяжитесь через README.
